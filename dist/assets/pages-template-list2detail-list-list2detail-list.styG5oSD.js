import{_ as t,k as a,aA as e,aa as s,r as i,a as l,c as n,w as o,e as d,o as r,b as u,d as c,u as h,t as _,K as m,F as f,x as p,f as g}from"./index-BmzQcWuq.js";import{_ as b}from"./uni-load-more.BfhI23-l.js";import{d as v}from"./util.BQsFLuvY.js";const D=t({data:()=>({banner:{},listData:[],last_id:"",reload:!1,status:"more",adpid:"",contentText:{contentdown:"上拉加载更多",contentrefresh:"加载中",contentnomore:"没有更多"}}),onLoad(){this.adpid=this.$adpid,this.getBanner(),this.getList()},onPullDownRefresh(){this.reload=!0,this.last_id="",this.getBanner(),this.getList()},onReachBottom(){this.status="more",this.getList()},methods:{getBanner(){a({url:"https://unidemo.dcloud.net.cn/api/banner/36kr",data:{column:"id,post_id,title,author_name,cover,published_at"},success:t=>{e(),200==t.statusCode&&(this.banner=t.data)},fail:(t,a)=>{console.log("fail"+JSON.stringify(t))}})},getList(){var t={column:"id,post_id,title,author_name,cover,published_at"};this.last_id&&(this.status="loading",t.minId=this.last_id,t.time=(new Date).getTime()+"",t.pageSize=10),a({url:"https://unidemo.dcloud.net.cn/api/news",data:t,success:t=>{if(200==t.statusCode){let a=this.setTime(t.data);this.listData=this.reload?a:this.listData.concat(a),this.last_id=a[a.length-1].id,this.reload=!1}},fail:(t,a)=>{console.log("fail"+JSON.stringify(t))}})},goDetail:function(t){let a={author_name:t.author_name,cover:t.cover,id:t.id,post_id:t.post_id,published_at:t.published_at,title:t.title};s({url:"../list2detail-detail/list2detail-detail?detailDate="+encodeURIComponent(JSON.stringify(a))})},setTime:function(t){var a=[];return t.forEach((t=>{a.push({author_name:t.author_name,cover:t.cover,id:t.id,post_id:t.post_id,published_at:v.format(t.published_at),title:t.title})})),a},aderror(t){console.log("aderror: "+JSON.stringify(t.detail))}}},[["render",function(t,a,e,s,v,D){const x=p,k=d,y=g,C=i(l("uni-load-more"),b);return r(),n(k,null,{default:o((()=>[u(k,{class:"banner",onClick:a[0]||(a[0]=t=>D.goDetail(v.banner))},{default:o((()=>[u(x,{class:"banner-img",src:v.banner.cover},null,8,["src"]),u(k,{class:"banner-title"},{default:o((()=>[c(h(v.banner.title),1)])),_:1})])),_:1}),u(k,{class:"uni-list"},{default:o((()=>[(r(!0),_(f,null,m(v.listData,((t,a)=>(r(),n(k,{key:a,class:"uni-list-cell","hover-class":"uni-list-cell-hover",onClick:a=>D.goDetail(t)},{default:o((()=>[u(k,{class:"uni-media-list"},{default:o((()=>[u(x,{class:"uni-media-list-logo",src:t.cover},null,8,["src"]),u(k,{class:"uni-media-list-body"},{default:o((()=>[u(k,{class:"uni-media-list-text-top"},{default:o((()=>[c(h(t.title),1)])),_:2},1024),u(k,{class:"uni-media-list-text-bottom"},{default:o((()=>[u(y,null,{default:o((()=>[c(h(t.author_name),1)])),_:2},1024),u(y,null,{default:o((()=>[c(h(t.published_at),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1}),u(C,{status:v.status,"icon-size":16,"content-text":v.contentText},null,8,["status","content-text"])])),_:1})}],["__scopeId","data-v-6761830d"]]);export{D as default};
