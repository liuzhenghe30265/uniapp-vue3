import{_ as t,g as e,s as o,a1 as i,r as n,a,c as s,w as u,y as c,e as l,o as p,b as r,d,v as f,u as g,f as h,i as m}from"./index-BmzQcWuq.js";import{_}from"./uni-popup.KVGyxqag.js";import{a as y}from"./util.BQsFLuvY.js";import"./uni-transition.32_0kIlH.js";var L=y;const S=t({data:()=>({title:"getLocation",hasLocation:!1,location:{},type:""}),methods:{togglePopup(t){this.type=t},showConfirm(){this.type="showpopup"},hideConfirm(){this.type=""},async getLocation(){this.doGetLocation()},doGetLocation(){e({success:t=>{this.hasLocation=!0,this.location=L(t.longitude,t.latitude)},fail:t=>{t.errMsg.indexOf("auth deny")>=0?o({title:"访问位置被拒绝"}):o({title:t.errMsg})}})},getSetting:function(){return new Promise(((t,e)=>{uni.getSetting({success:e=>{void 0!==e.authSetting["scope.userLocation"]?e.authSetting["scope.userLocation"]?t(1):t(2):t(0)}})}))},openSetting:function(){this.hideConfirm(),uni.openSetting({success:t=>{t.authSetting&&t.authSetting["scope.userLocation"]&&this.doGetLocation()},fail:t=>{}})},async checkPermission(){let t=permision.isIOS?await permision.requestIOS("location"):await permision.requestAndroid("android.permission.ACCESS_FINE_LOCATION");return null===t||1===t?t=1:2===t?i({content:"系统定位已关闭",confirmText:"确定",showCancel:!1,success:function(t){}}):t.code?i({content:t.message}):i({content:"需要定位权限",confirmText:"设置",success:function(t){t.confirm&&permision.gotoAppSetting()}}),t},clear:function(){this.hasLocation=!1}}},[["render",function(t,e,o,i,y,L){const S=n(a("page-head"),c),C=l,w=h,k=m,x=n(a("uni-popup"),_);return p(),s(C,null,{default:u((()=>[r(S,{title:y.title},null,8,["title"]),r(C,{class:"uni-padding-wrap"},{default:u((()=>[r(C,{style:{background:"#FFFFFF",padding:"40rpx"}},{default:u((()=>[r(C,{class:"uni-hello-text uni-center"},{default:u((()=>[d("当前位置经纬度")])),_:1}),!1===y.hasLocation?(p(),s(C,{key:0,class:"uni-h2 uni-center uni-common-mt"},{default:u((()=>[d("未获取")])),_:1})):f("",!0),!0===y.hasLocation?(p(),s(C,{key:1,class:"uni-h2 uni-center uni-common-mt"},{default:u((()=>[r(w,null,{default:u((()=>[d("E: "+g(y.location.longitude[0])+"°"+g(y.location.longitude[1])+"′",1)])),_:1}),r(w,null,{default:u((()=>[d("\\nN: "+g(y.location.latitude[0])+"°"+g(y.location.latitude[1])+"′",1)])),_:1})])),_:1})):f("",!0)])),_:1}),r(C,{class:"uni-btn-v"},{default:u((()=>[r(k,{type:"primary",onClick:L.getLocation},{default:u((()=>[d("获取位置")])),_:1},8,["onClick"]),r(k,{onClick:L.clear},{default:u((()=>[d("清空")])),_:1},8,["onClick"])])),_:1})])),_:1}),r(x,{show:"showpopup"===y.type,mode:"fixed",onHidePopup:e[1]||(e[1]=t=>L.togglePopup(""))},{default:u((()=>[r(C,{class:"popup-view"},{default:u((()=>[r(w,{class:"popup-title"},{default:u((()=>[d("需要用户授权位置权限")])),_:1}),r(C,{class:"uni-flex popup-buttons"},{default:u((()=>[r(k,{class:"uni-flex-item",type:"primary","open-type":"openSetting",onClick:L.openSetting},{default:u((()=>[d("设置")])),_:1},8,["onClick"]),r(k,{class:"uni-flex-item",onClick:e[0]||(e[0]=t=>L.togglePopup(""))},{default:u((()=>[d("取消")])),_:1})])),_:1})])),_:1})])),_:1},8,["show"])])),_:1})}],["__scopeId","data-v-d9df7ac7"]]);export{S as default};
